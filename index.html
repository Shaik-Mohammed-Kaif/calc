<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Casio Calculator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap');
* { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins', sans-serif; }
body {
    width:100%; height:100vh; display:flex; justify-content:center; align-items:center;
    background: linear-gradient(45deg, #0a0a0a, #3a4452); animation: gradient-animation 15s ease infinite;
    background-size: 200% 200%; flex-direction: column; color: #d8d8d8; padding: 20px;
}
@keyframes gradient-animation {
    0% {background-position:0% 50%;} 50% {background-position:100% 50%;} 100% {background-position:0% 50%;}
}
.calculator-container {
    width: 450px; max-width: 95%; padding:30px; border-radius:20px; background: rgba(0,0,0,0.6);
    box-shadow:0px 10px 30px rgba(113,115,119,0.9); border:1px solid #4a4a4a;
}
.display {
    background-color:#2e3034; border:1px solid #444; border-radius:10px; padding:20px; margin-bottom:25px;
    box-shadow:inset 0px 2px 10px rgba(0,0,0,0.5); min-height:100px; display:flex; flex-direction:column;
    justify-content:flex-end; align-items:flex-end; overflow:hidden; position:relative;
}
.expression-history { font-size:16px; color:#999; height:30px; text-align:right; white-space:nowrap; overflow-x:auto; direction:rtl; }
.input-box { font-size:48px; color:#ffffff; font-weight:500; text-align:right; width:100%; white-space:nowrap; overflow-x:auto; direction:rtl; }

.buttons-grid { display:grid; grid-template-columns:repeat(5,1fr); gap:12px; }
.button { width:70px; height:70px; border:none; border-radius:15px; background:#444; color:#fff; font-size:22px; font-weight:500; cursor:pointer; transition:all 0.2s ease; box-shadow:0px 4px 8px rgba(0,0,0,0.4); position:relative; }
.button:active { transform:translateY(2px); box-shadow:0px 2px 4px rgba(0,0,0,0.4); }

.number { background-color:#555; } .operator { background-color:#f1a33c; } .function { background-color:#4466aa; font-size:18px; }
.equals { background-color:#2b7746; font-size:30px; } .clear { background-color:#cc4f4f; } .backspace { background-color:#7b4fcc; }
.equals-row { grid-column: span 2; } .clear-col { grid-row: span 2; }

/* === Mobile Responsiveness === */
@media (max-width: 500px) {
    .calculator-container { width:100%; padding:15px; }
    .buttons-grid { grid-template-columns:repeat(4,1fr); gap:6px; }
    .button { width:100%; height:50px; font-size:16px; }
    .function { font-size:14px; }
    .equals { font-size:24px; }
    .display { padding:10px; min-height:80px; }
    .input-box { font-size:28px; }
    .expression-history { font-size:14px; height:20px; }
    .buttons-grid button[data-value="!"] { display:none; }
    .buttons-grid button[data-value="pi"], .buttons-grid button[data-value="e"] { font-size:14px; }
}
</style>
</head>
<body>
<div class="calculator-container">
    <div class="display">
        <div class="expression-history" id="historyBox"></div>
        <div class="input-box" id="inputBox">0</div>
    </div>

    <div class="buttons-grid">
        <button class="button function" data-value="sin(">sin</button>
        <button class="button function" data-value="cos(">cos</button>
        <button class="button function" data-value="tan(">tan</button>
        <button class="button function" data-value="log10(">log</button>
        <button class="button function" data-value="log(">ln</button>

        <button class="button function" data-value="sqrt(">√</button>
        <button class="button function" data-value="^">^</button>
        <button class="button function" data-value="(">(</button>
        <button class="button function" data-value=")">)</button>
        <button class="button function" data-value="!">n!</button>

        <button class="button number" data-value="7">7</button>
        <button class="button number" data-value="8">8</button>
        <button class="button number" data-value="9">9</button>
        <button class="button operator" data-value="/">/</button>
        <button class="button operator" data-value="*">*</button>

        <button class="button number" data-value="4">4</button>
        <button class="button number" data-value="5">5</button>
        <button class="button number" data-value="6">6</button>
        <button class="button operator" data-value="-">-</button>
        <button class="button operator" data-value="+">+</button>

        <button class="button number" data-value="1">1</button>
        <button class="button number" data-value="2">2</button>
        <button class="button number" data-value="3">3</button>
        <button class="button operator" data-value="%">%</button>
        <button class="button operator" data-value=".">.</button>

        <button class="button number" data-value="0">0</button>
        <button class="button function" data-value="pi">π</button>
        <button class="button function" data-value="e">e</button>
        <button class="button clear" data-value="AC">AC</button>
        <button class="button backspace" data-value="DEL">DEL</button>

        <button class="button equals" data-value="=" style="grid-column: span 2;">=</button>
    </div>
</div>

<script>
const inputBox = document.getElementById('inputBox');
const historyBox = document.getElementById('historyBox');
const buttons = document.querySelectorAll('.button');

let expression = '';
let resultDisplayed = false;

buttons.forEach(button=>{
    button.addEventListener('click', ()=>{
        const value = button.getAttribute('data-value');
        if(value==='AC'){ expression=''; inputBox.textContent='0'; historyBox.textContent=''; resultDisplayed=false; return; }
        if(value==='DEL'){ expression=expression.slice(0,-1); inputBox.textContent=expression||'0'; return; }
        if(value==='='){
            try{
                let sanitized = expression.replace(/π/g,'pi').replace(/e/g,'e').replace(/\^/g,'**');
                if(sanitized.includes('!')){
                    let parts = sanitized.split('!');
                    let num = math.evaluate(parts[0]);
                    if(num<0 || !Number.isInteger(num)) throw new Error("Factorial error");
                    let factorialResult = math.factorial(num);
                    historyBox.textContent = expression+' =';
                    inputBox.textContent = factorialResult;
                    expression = factorialResult.toString();
                }else{
                    const finalResult = math.evaluate(sanitized);
                    historyBox.textContent = expression+' =';
                    inputBox.textContent = finalResult;
                    expression = finalResult.toString();
                }
                resultDisplayed = true;
            }catch(e){ inputBox.textContent='Error'; historyBox.textContent=''; expression=''; resultDisplayed=true; }
            return;
        }
        if(resultDisplayed){
            if(['+','-','*','/','%','^'].includes(value)){ expression=inputBox.textContent+value; }
            else{ expression=value; }
            resultDisplayed=false;
        }else{ expression+=value; }
        inputBox.textContent=expression;
    });
});

// Keyboard support
document.addEventListener('keydown',(e)=>{
    const key=e.key;
    const valid='0123456789.+-*/^()';
    const special={Enter:'=',Backspace:'DEL',Escape:'AC'};
    let buttonValue=null;
    if(valid.includes(key)) buttonValue=key;
    else if(special[key]) buttonValue=special[key];
    else if(key==='p') buttonValue='π';
    else if(key==='e') buttonValue='e';
    else return;
    const btn=document.querySelector(`[data-value="${buttonValue}"]`);
    if(btn) btn.click();
});
</script>
</body>
</html>
